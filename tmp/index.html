<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script>
    function objectifyForm(formArray) { //serialize data function
        var returnArray = {};
        for (var i = 0; i < formArray.length; i++){
            returnArray[formArray[i]['name']] = formArray[i]['value'];
        }
        var metaArray = {};
        metaArray['index'] = 'hec_devopskorea';
        metaArray['sourcetype'] = 'httpevent';
        metaArray['source'] = 'hec_devopskorea';
        returnArray['metaInfo'] = metaArray;
        return returnArray;
    }
</script>

<title>KOREA DevOps meetup '18</title>
<!-- css -->
<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="bower_components/ionicons/css/ionicons.min.css">
<link rel="stylesheet" href="assets/css/main.css">
<link rel="icon" href="assets/images/icons/xxxhdpi.png">

</head>

<bodylang="ko">

    <div class="col-md-12">
        <h3 class="section-title">Registration</h3>
    </div>
                
    <form method="POST" id="hec">
        <div class="row">
            <div class="col-md-12" id="registration-msg" style="display:none;">
                <div class="alert"></div>
            </div>
            <div class="col-sm-6">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Name" id="name" name="name" required>
                </div>

                <div class="form-group">
                    <input type="email" class="form-control" placeholder="Email" id="email" name="email" required>
                </div>

                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Phone" id="cell" name="cell" required>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Zip Code" id="zip" name="zip" required>
                </div>

                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Address" id="address" name="address" required>
             </div>

                <div class="form-group">
                    <select class="form-control" name="program" id="program" required>
                        <option readonly>Select Your Program</option>
                        <option>Program Name 1</option>
                        <option>Program Name 2</option>
                        <option>Program Name 3</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="text-center mt20">
            <button type="submit" class="btn btn-black" id="registration-submit-btn">Submit</button>
        </div>
    </form>
    <script>
        $( "form" ).submit(function( event ) {
            var allData = $( this ).serializeArray();
            var jsonData = objectifyForm(allData);
            console.log(jsonData);
    
            $.ajax({
                //url: "http://splunk.ecomx.asia:8088/services/collector/event",
                url: "http://localhost:8088/services/collector/event", //localhost
                async: true,
                contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
                method: 'POST',
                crossDomain: true,
                data: JSON.stringify({ event: jsonData }),
                headers: {
                    "Authorization": "Splunk 4db90e00-2419-4713-980d-99d6b453e886" //localhost
                    //"Authorization": "Splunk 7f9768b4-0c60-4cba-8dda-7c4ae8c06402" //splunk.ecomx.asia
                },
                success: function(data) {
                console.log("1")
                console.log(data)
                },
                error: function(error) {
                console.log(error);
                }
            });
            location.href = "./thsnks.html";
        });
    </script>
</body>
</html>
